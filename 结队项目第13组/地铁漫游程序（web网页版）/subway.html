<!DOCTYPE html>
<html>

<head>
	<title> 地铁换乘服务</title>
	<meta charset="UTF-8" />

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>

		// define 
		const beijing_subway = "1号线$苹果园 古城 八角游乐园 八宝山 玉泉路 五棵松 万寿路 公主坟 军事博物馆 木樨地 南礼士路 复兴门 西单 天安门西 天安门东 王府井 东单 建国门 永安里 国贸 大望路 四惠 四惠东$1号线（快车）$公主坟 军事博物馆 复兴门 西单 东单 建国门 国贸 大望路 四惠 四惠东$八通线$四惠 四惠东 高碑店 传媒大学 双桥 管庄 八里桥 通州北苑 果园 九棵树 梨园 临河里 土桥 花庄 环球度假区$2号线$西直门 积水潭 鼓楼大街 安定门 雍和宫 东直门 东四十条 朝阳门 建国门 北京站 崇文门 前门 和平门 宣武门 长椿街 复兴门 阜成门 车公庄 西直门$4号线$安河桥北 北宫门 西苑 圆明园 北京大学东门 中关村 海淀黄庄 人民大学 魏公村 国家图书馆 动物园 西直门 新街口 平安里 西四 灵境胡同 西单 宣武门 菜市口 北京南站 马家堡 角门西$大兴线$角门西 公益西桥 新宫 西红门 高米店北 高米店南 枣园 清源路 黄村西大街 黄村火车站 义和庄 生物医药基地 天宫院$5号线$天通宛北 天通宛 天通宛南 立水桥 立水桥南 北苑路北 大屯路东 惠新西街北口 惠新西街南口 和平西桥 和平里北桥 雍和宫 北新桥 张自忠路 东四 灯市口 东单 崇文门 磁器口 天坛东门 蒲黄榆 刘家窑 宋家庄$5号线（快车）$立水桥 大屯路东 惠新西街南口 雍和宫 东四 东单 崇文门 磁器口 蒲黄榆 宋家庄$6号线$金安桥 杨庄 西黄村 廖公庄 田村 海淀五路居 慈寿寺 花园桥 白石桥南 车公庄西 车公庄 平安里 北海北 南锣鼓巷 东四 朝阳门 东大桥 呼家楼 金台路 十里堡 青年路 褡裢坡 黄渠 常营 草房 物资学院路 通州北关 通运门 北运河西 北运河东 郝家府 东夏园 潞城$7号线$环球度假区 花庄 高楼金 群芳 万盛东 万盛西 黑庄户 郎辛庄 黄厂 焦化厂 双合 垡头 欢乐谷景区 南楼梓庄 化工 百子湾 大郊亭 九龙山 双井 广渠门外 广渠门内 磁器口 桥湾 珠市口 虎坊桥 菜市口 广安门内 达官营 湾子 北京西站$8号线（北段）$朱辛庄 育知路 平西府 回龙观东大街 霍营 育新 西小口 永泰庄 林翠桥 森林公园南门 奥林匹克公园 奥体中心 北土城 安华桥 安德里北街 鼓楼大街 什刹海 南锣鼓巷 中国美术馆$8号线（南段）$珠市口 天桥 永定门外 木樨园 海户屯 大红门南 和义 东高地 火箭万源 五福堂 德茂 瀛海$9号线$郭公庄 丰台科技园 科怡路 丰台南路 丰台东大街 七里庄 六里桥 六里桥东 北京西站 军事博物馆 白堆子 白石桥南 国家图书馆$10号线$巴沟 苏州街 海淀黄庄 知春里 知春路 西土城 牡丹园 健德门 北土城 安贞门 惠新西街南口 芍药居 太阳宫 三元桥 亮马桥 农业展览馆 团结湖 呼家楼 金台夕照 国贸 双井 劲松 潘家园 十里河 分钟寺 成寿寺 宋家庄 石榴庄 大红门 角门东 角门西 草桥 纪家庙 首经贸 丰台站 泥洼 西局 六里桥 莲花桥 公主坟 西钓鱼台 慈寿寺 车道沟 长春桥 火器营 巴沟$13号线$西直门 大钟寺 知春路 五道口 上地 清河 西二旗 龙泽 回龙观 霍营 立水桥 北苑 望京西 芍药居 光熙门 柳芳 东直门$14号线（西段）$张郭庄 园博园 大瓦窑 郭庄子 大井 七里庄 西局$14号线（东段）$善各庄 来广营 东湖渠 望京 阜通 望京南 高家园 将台 东风北桥 枣营 朝阳公园 金台路 大望路 九龙山 平乐园 北工大西门 十里河 方庄 蒲黄榆 景泰 永定门外 陶然桥 北京南站$15号线 6 22$清华东路西口 六道口 北沙滩 奥林匹克公园 安立路 大屯路东 关庄 望京西 望京 望京东 崔各庄 马泉营 孙河 国展 花梨坎 后沙峪 南法信 石门 顺义 俸伯$16号线$北安河 温阳路 稻香湖路 屯佃 永丰 永丰南 西北旺 马连洼 农大南路 西苑$房山线$阎村东 苏庄 良乡南关 良乡大学城西 良乡大学城 良乡大学城北 广阳城 篱笆房 长阳 稻田 大葆台 郭公庄$昌平线$昌平西山口 十三陵景区 昌平 昌平东关 北邵洼 南邵 沙河高教园 沙河 巩华城 朱辛庄 生命科学园 西二旗$亦庄线$亦庄火车站 次渠 次渠南 经海路 同济南路 荣昌东街 荣京东街 万源街 亦庄文化园 亦庄桥 旧宫 小红门 肖村 宋家庄$燕房线$燕山 房山城关 饶乐府 马各庄 大石河东 星城 阎村 紫草坞 阎村东$西郊线$香山 植物园 万安 茶棚 颐和园西门 巴沟$S1线$石厂 小园 栗园庄 上岸 桥户营 四道桥 金安桥$首都机场线$3号航站楼 2号航站楼 三元桥 东直门$大兴机场线$大兴机场 大兴新城 草桥$北理良乡线$良乡大学城北 北理体育馆 北理文教楼 北理综教楼 北理理教楼";
		const beijing_map = "1号线 194 55 50$1号线（快车） 194 55 50$八通线 194 55 50$2号线 17 97 150$4号线 0 140 157$大兴线 0 140 157$5号线 167 28 127$5号线（快车） 167 28 127$6号线 208 151 10$7号线 250 198 114$8号线（北段） 2 155 108$8号线（南段） 2 155 108$9号线 144 195 32$10号线 1 154 195$13号线 246 230 20$14号线（西段） 215 166 162$14号线（东段） 215 166 162$15号线 107 54 124$16号线 119 162 46$房山线 229 95 32$昌平线 223 131 180$亦庄线 227 2 120$燕房线 229 95 32$西郊线 228 5 24$S1线 179 90 32$首都机场线 164 154 189$大兴机场线 1 76 159$北理良乡线 255 0 0$昌平西山口 1 20$十三陵景区 1 22$昌平 2 23$昌平东关 2 24$北邵洼 2 26$南邵 3 27$沙河高教园 4 27$沙河 5 27$巩华城 6 27$朱辛庄 7 27$生命科学园 8 26$西二旗 9 26$育知路 7 28$平西府 7 29$回龙观东大街 8 29$霍营 9 29$育新 10 29$西小口 11 29$永泰庄 12 29$林翠桥 13 30$森林公园南门 14 31$奥林匹克公园 15 31$奥体中心 16 31$安华桥 18 31$安德里北街 19 31$鼓楼大街 20 31$什刹海 21 31$南锣鼓巷 22 32$中国美术馆 23 33$西直门 21 27$大钟寺 19 26$知春路 17 26$五道口 16 26$上地 13 26$清河 11 26$龙泽 9 27$回龙观 9 28$立水桥 9 34$北苑 11 36$望京西 15 36$光熙门 19 36$柳芳 20 36$东直门 21 35$天通宛北 6 34$天通宛 7 34$天通宛南 8 34$立水桥南 11 34$北苑路北 13 34$大屯路东 15 34$惠新西街北口 16 34$和平西桥 18 34$和平里北桥 19 34$雍和宫 20 34$北新桥 21 34$张自忠路 22 34$东四 23 34$灯市口 24 34$东单 25 34$崇文门 26 34$磁器口 27 34$天坛东门 28 34$蒲黄榆 30 34$刘家窑 31 34$宋家庄 33 34$清华东路西口 15 27$六道口 15 28$北沙滩 15 29$安立路 15 32 $关庄 15 35$望京 15 38$望京东 15 40$崔各庄 12 42$马泉营 11 42$孙河 10 42$国展 9 42$花梨坎 8 42$后沙峪 7 42$南法信 6 43$石门 6 45$顺义 6 47$俸伯 6 49$巴沟 17 20$苏州街 17 22$海淀黄庄 17 23$知春里 17 24$西土城 17 28$牡丹园 17 29$健德门 17 30$北土城 17 31$安贞门 17 32$惠新西街南口 17 34$芍药居 17 36$太阳宫 17 38$三元桥 19 38$亮马桥 20 38$农业展览馆 21 38$团结湖 22 38$呼家楼 23 38$金台夕照 24 38$国贸 25 38$双井 27 38$劲松 28 38$潘家园 29 38$十里河 30 38$分钟寺 33 38$成寿寺 33 36$石榴庄 33 33$大红门 33 30$角门东 33 29$角门西 33 28$草桥 33 27$纪家庙 33 25$首经贸 33 23$丰台站 32 21$泥洼 31 21$西局 30 21$六里桥 28 21$莲花桥 26 21$公主坟 25 21$西钓鱼台 23 21$慈寿寺 22 20$车道沟 21 20$长春桥 20 20$火器营 18 20$香山 14 13$植物园 14 15$万安 15 16$茶棚 16 17$颐和园西门 16 19$安河桥北 11 18$北宫门 11 20$西苑 11 22$圆明园 13 23$北京大学东门 15 23$中关村 16 23$人民大学 18 23$魏公村 19 23$国家图书馆 21 23$动物园 21 25$新街口 21 28$平安里 22 28$西四 23 28$灵境胡同 24 28$西单 25 28$宣武门 26 28$菜市口 27 28$北京南站 30 28$马家堡 31 28$公益西桥 34 28$新宫 35 28$西红门 36 26$高米店北 37 26$高米店南 38 26$枣园 39 26$清源路 40 26$黄村西大街 41 26$黄村火车站 42 26$义和庄 43 26$生物医药基地 44 26$天宫院 45 26$郭公庄 35 20$丰台科技园 34 20$科怡路 33 20$丰台南路 32 20$丰台东大街 31 20$七里庄 30 20$六里桥东 27 22$北京西站 26 23$军事博物馆 25 23$白堆子 24 23$阎村东 42 9$苏庄 42 10$良乡南关 42 11$良乡大学城西 42 12$良乡大学城 42 13$良乡大学城北 41 14$广阳城 40 15$篱笆房 39 16$长阳 38 17$稻田 37 18$大葆台 36 19$燕山 40 1$房山城关 41 2$饶乐府 42 3$马各庄 42 4$大石河东 42 5$星城 42 6$阎村 42 7$紫草坞 42 8$环球度假区 33 53$花庄 32 54$高楼金 31 53$群芳 31 52$万盛东 31 51$万盛西 31 50$黑庄户 31 49$郎辛庄 31 48$黄厂 31 47$焦化厂 31 46$双合 31 45$垡头 31 44$欢乐谷景区 30 43$南楼梓庄 29 43$化工 28 43$百子湾 27 42$大郊亭 27 41$九龙山 27 40$广渠门外 27 36$广渠门内 27 35$桥湾 27 33$珠市口 27 31$虎坊桥 27 30$广安门内 27 27$达官营 27 25$湾子 27 24$石厂 27 8$小园 27 9$栗园庄 26 10$上岸 25 10$桥户营 24 11$四道桥 24 12$金安桥 24 13$杨庄 23 15$西黄村 22 16$廖公庄 22 17$田村 22 18$海淀五路居 22 19$花园桥 22 22$白石桥南 22 23$车公庄西 22 25$车公庄 22 27$北海北 22 30$朝阳门 23 35$东大桥 23 37$金台路 23 40$十里堡 23 41$青年路 23 42$褡裢坡 23 43$黄渠 23 44$常营 23 45$草房 23 46$物资学院路 23 47$通州北关 23 48$通运门 24 49$北运河西 25 50$北运河东 25 51$郝家府 25 52$东夏园 25 53$潞城 25 54$苹果园 24 14$古城 25 15$八角游乐园 25 16$八宝山 25 17$玉泉路 25 18$五棵松 25 19$万寿路 25 20$木樨地 25 25$南礼士路 25 26$复兴门 25 27$天安门西 25 30$天安门东 25 32$王府井 25 33$建国门 25 35$永安里 25 37$大望路 25 40$四惠 25 42$四惠东 25 43$高碑店 25 44$传媒大学 25 45$双桥 25 46$管庄 25 47$八里桥 25 48$通州北苑 26 49$果园 27 50$九棵树 28 51$梨园 29 52$临河里 30 53$土桥 31 54$亦庄火车站 42 46$次渠 42 45$次渠南 42 44$经海路 42 43$同济南路 42 42$荣昌东街 41 41$荣京东街 40 40$万源街 39 39$亦庄文化园 38 38$亦庄桥 37 37$旧宫 36 36$小红门 35 35$肖村 34 34$天桥 28 31$永定门外 30 31$木樨园 31 31$海户屯 32 31$大红门南 34 31$和义 35 31$东高地 36 32$火箭万源 37 33$五福堂 38 34$德茂 39 35$瀛海 40 36$张郭庄 30 15$园博园 30 16$大瓦窑 30 17$郭庄子 30 18$大井 30 19$善各庄 12 38$来广营 13 38$东湖渠 14 38$阜通 16 38$望京南 17 39$高家园 18 40$将台 19 40$东风北桥 20 40$枣营 21 40$朝阳公园 22 40$平乐园 28 40$北工大西门 30 39$方庄 30 36$景泰 30 33$陶然桥 30 30$积水潭 20 29$安定门 20 32$东四十条 22 35$北京站 26 35$前门 26 31$和平门 26 30$长椿街 26 27$阜成门 24 27$大兴机场 45 29$大兴新城 38 29$3号航站楼 9 47$2号航站楼 9 45$北安河 7 12$温阳路 7 14$稻香湖路 7 16$屯佃 7 18$永丰 7 20$永丰南 7 22$西北旺 8 22$马连洼 9 22$农大南路 10 22$北理体育馆 43 14$北理文教楼 45 14$北理综教楼 47 14$北理理教楼 47 16";
		const wuhan_subway = "1号线$泾河 三店 码头潭公园 东吴大道 五环大道 额头湾 竹叶海 舵落口 古田一路 古田二路 古田三路 古田四路 汉西一路 宗关 太平洋 硚口路 崇仁路 利济北路 友谊路 循礼门 大智路 三阳路 黄浦路 头道街 二七路 徐州新村 丹水池 新荣 堤角 藤子岗 滠口新城 汉口北$2号线$天河机场 航空总部 宋家岗 巨龙大道 盘龙城 宏图大道 常青城 金银潭 常青花园 长港路 汉口火车站 范湖 王家墩东 青年路 中山公园 循礼门 江汉路 积玉桥 螃蟹岬 小龟山 洪山广场 中南路 宝通寺 街道口 广埠屯 虎泉 杨家湾 光谷广场 珞雄路 华中科技大学 光谷大道 佳园路 武汉东站 黄龙山路 金融港北 秀湖 藏龙东街 佛祖岭$3号线$宏图大道 市民之家 后湖大道 兴业路 二七小路 罗家庄 赵家条 惠济二路 香港路 菱角湖 范湖 云飞路 武汉商务区 双墩 宗关 王家湾 龙阳村 陶家岭 四新大道 汉阳客运站 三角湖 体育中心 东风公司 沌阳大道$4号线$柏林 新庙村 临漳大道 蔡甸广场 凤凰路 新农 知音 集贤 新天 黄金口 孟家铺 永安堂 玉龙路 王家湾 十里铺 七里庙 五里墩 汉阳火车站 钟家村 拦江路 复兴路 首义路 武昌火车站 梅苑小区 中南路 洪山广场 楚河汉街 青鱼嘴 东亭 岳家嘴 铁机路 罗家港 园林路 仁和路 工业四路 杨春湖 武汉火车站$5号线$武汉站东广场 厂前 武钢 工人村 青宜居 红钢城 和平公园 建设二路 科普公园 余家头 杨园铁四院 徐家棚 三角路 三层楼 积玉桥 昙华林武胜门 司门口黄鹤楼 彭刘杨 复兴路 八铺街 烽火村 张家湾 光霞 白沙六路 中医药大学$6号线$新城十一路 码头潭公园 五环体育中心 二雅路 海口三路 金银湖公园 金银湖 园博园北 轻工大学 常青花园 杨汊湖 石桥 唐家墩 三眼桥 香港路 苗栗路 大智路 江汉路 六渡桥 汉正街 武胜路 琴台 钟家村 马鹦路 建港 前进村 园博中心北 园博中心南 老关村 江城大道 车城东路 东风公司$7号线$横店 裕福路 天阳大道 腾龙大道 巨龙大道 汤云海路 马池 园博园北 园博园 常码头 武汉商务区 王家墩东 取水楼 香港路 三阳路 徐家棚 湖北大学 新河街 螃蟹岬 小东门 武昌火车站 瑞安街 建安街 湖工大 板桥 野芷湖 新路村 大花岭 江夏客厅 谭鑫培公园 北华街 纸坊大街 青龙山地铁小镇$8号线$军运村 黄家湖地铁小镇 野芷湖 马湖 省农科院 文昌路 文治街 马房山 街道口 小洪山 洪山路 水果湖 中南医院 省博湖北日报 梨园 岳家嘴 汪家墩 徐东 徐家棚 黄浦路 赵家条 竹叶山 中一路 塔子湖 宏图大道 金潭路$阳逻线$金台 施岗 阳逻开发区 阳逻 武生院 军民村 沙口 武湖 高车 青龙 谌家矶 朱家河 幸福湾 新荣 百步亭花园路 后湖大道$11号线$武汉东站 湖口 光谷同济医院 光谷生物园 光谷四路 光谷五路 光谷六路 豹澥 光谷七路 长岭山 未来一路 未来三路 左岭 葛店南站$16号线$通航机场 纱帽 周家河 湾湖 协子河 马影河 桂子湖 大军山 枫林 小军山 沌口 南太子湖 老关村 园博中心南$";
		const wuhan_map = "1号线 55 134 200$2号线 235 124 174$3号线 221 185 101$4号线 142 203 31$5号线 231 55 43$6号线 0 134 52$7号线 239 120 1$8号线 153 174 174$阳逻线 211 1 149$11号线 243 211 1$16号线 203 0 84$泾河 12 22$三店 13 22$码头潭公园 14 22$东吴大道 15 22$五环大道 16 22$额头湾 17 22$竹叶海 18 23$舵落口 19 24$古田一路 20 25$古田二路 21 26$古田三路 22 27$古田四路 23 28$汉西一路 24 29$宗关 26 30$太平洋 26 31$硚口路 25 32$崇仁路 24 33$利济北路 23 30$友谊路 22 31$循礼门 21 32$大智路 20 33$三阳路 19 34$黄浦路 18 35$头道街 17 36$二七路 16 37$徐州新村 15 38$丹水池 14 39$新荣 13 40$堤角 12 41$藤子岗 11 42$滠口新城 10 43$汉口北 9 44$天河机场 8 28$航空总部 8 29$宋家岗 8 30$巨龙大道 8 32$盘龙城 10 34$宏图大道 12 36$常青城 12 35$金银潭 12 34$常青花园 14 30$长港路 15 30$汉口火车站 16 30$范湖 17 30$王家墩东 18 30$青年路 19 30$中山公园 19 31$江汉路 22 33$积玉桥 25 34$螃蟹岬 26 35$小龟山 27 35$洪山广场 28 35$中南路 29 34$宝通寺 30 35$街道口 31 36$广埠屯 32 37$虎泉 33 38$杨家湾 34 39$光谷广场 35 40$珞雄路 35 41$华中科技大学 35 42$光谷大道 35 44 $佳园路 35 45$黄龙山路 36 46$金融港北 37 46$秀湖 38 46$藏龙东街 39 46$佛祖岭 40 46$市民之家 12 38$后湖大道 13 38$兴业路 13 36$二七小路 14 35$罗家庄 15 34$赵家条 16 33$惠济二路 17 32$香港路 18 31$菱角湖 15 29$云飞路 17 29$武汉商务区 18 28$双墩 22 29$王家湾 22 23$龙阳村 23 22$陶家岭 24 21$四新大道 25 20$汉阳客运站 26 19$三角湖 27 18$体育中心 28 17$东风公司 29 16$沌阳大道 30 15$柏林 22 10$新庙村 22 11$临漳大道 22 12$蔡甸广场 22 13$凤凰路 22 14$新农 22 15$知音 22 16$集贤 22 17$新天 22 18$黄金口 22 19$孟家铺 22 20$永安堂 22 21$玉龙路 22 22$十里铺 23 24$七里庙 24 25$五里墩 25 26$汉阳火车站 26 27$钟家村 27 28$拦江路 28 29$复兴路 29 30$首义路 30 31$武昌火车站 30 32$梅苑小区 30 33$楚河汉街 27 36$青鱼嘴 26 37$东亭 25 38$岳家嘴 24 39$铁机路 23 40$罗家港 22 41$园林路 21 42$仁和路 20 43$工业四路 19 44$杨春湖 18 45$武汉火车站 17 46$武汉站东广场 13 48$厂前 12 47$武钢 13 46$工人村 14 45$青宜居 15 44$红钢城 16 43$和平公园 17 42$建设二路 18 41$科普公园 19 40$余家头 20 39$杨园铁四院 21 38$徐家棚 22 37$三角路 23 36$三层楼 24 35$昙华林武胜门 26 33$司门口黄鹤楼 27 32$彭刘杨 28 31$八铺街 30 29$烽火村 31 28$张家湾 32 28$光霞 33 28$白沙六路 34 28$中医药大学 35 28$新城十一路 14 20$五环体育中心 14 23$二雅路 14 24$海口三路 14 25$金银湖公园 14 26$金银湖 14 27$园博园北 14 28$轻工大学 14 29$杨汊湖 14 31$石桥 15 31$唐家墩 16 31$三眼桥 17 31$苗栗路 19 32$六渡桥 23 32$汉正街 24 31$武胜路 25 30$琴台 26 29$马鹦路 28 27$建港 29 26$前进村 30 25$园博中心北 31 24$园博中心南 32 23$老关村 33 22$江城大道 32 20$车城东路 31 18$横店 6 37$裕福路 6 36$天阳大道 6 34$腾龙大道 7 33$汤云海路 12 28$马池 13 28$园博园 14 28$常码头 15 28$取水楼 21 29$湖北大学 23 37$新河街 24 37$小东门 27 34$瑞安街 31 32$建安街 32 32$湖工大 33 32$板桥 34 32$野芷湖 35 32$新路村 36 32$大花岭 37 32$江夏客厅 38 32$谭鑫培公园 39 32$北华街 40 32$纸坊大街 41 32$青龙山地铁小镇 42 32$军运村 43 30$黄家湖地铁小镇 35 30$马湖 35 33$省农科院 35 34$文昌路 34 34$文治街 33 34$马房山 32 35$小洪山 30 37$洪山路 29 38$水果湖 28 39$中南医院 27 40$省博湖北日报 26 41$梨园 25 40$汪家墩 23 39$徐东 23 38$竹叶山 15 33$中一路 14 34$塔子湖 13 35$金潭路 10 36$金台 9 53$施岗 9 52$阳逻开发区 9 51$阳逻 9 50$武生院 9 49$军民村 9 48$沙口 9 47$武湖 9 46$高车 9 45$青龙 10 44$谌家矶 11 43$朱家河 12 42$幸福湾 13 41$百步亭花园路 13 39$武汉东站 35 46$湖口 35 47$光谷同济医院 35 48$光谷生物园 35 50$光谷四路 36 50$光谷五路 37 50$光谷六路 38 50$豹澥 39 50$光谷七路 40 50$长岭山 41 50$未来一路 42 50$未来三路 43 50$左岭 44 50$葛店南站 45 50$通航机场 37 9$纱帽 37 11$周家河 37 12$湾湖 37 13$协子河 37 14$马影河 37 15$桂子湖 37 16$大军山 37 17$枫林 37 18$小军山 36 19$沌口 35 20$南太子湖 34 21";

		const szx = 17, szy = 30;
		const INF = 999999;

		let point_count, line_count;
		let line_name = [], point_name = [];
		let line = [];
		let point_index = new Map();
		let is_change = [];
		let point_pos = [], line_time = [], line_color = [];
		let city;/* 0 beijing 1 wuhan */
		let fun; //  当前调用的是需求几

		let showing_id = 0;
		let showing_path = [0];
		let showing_handle, flick_handle;

		function main() {

			let map_container = $("#map-container");
			city = 0;
			load();
			draw(map_container);
		}

		window.onload = main;
		function show(x) { console.log(x); }
		function draw(map) {
			// draw line
			for (let i = 0; i < line_count; ++i) {
				let l = line[i];
				for (let j = 1; j < l.length; ++j) {
					let x = l[j], y = l[j - 1];
					draw_line(point_pos[x].x * szx, point_pos[x].y * szy,
						point_pos[y].x * szx, point_pos[y].y * szy, map, i, x, y);
				}
			}
			// draw_point and name
			for (let i = 0; i < point_count; ++i) {
				draw_point(point_pos[i].x * szx, point_pos[i].y * szy, is_change[i], map, i);
			}
			// draw input
			draw_input(map);
		}
		function load() {
			let sbw_s, map_s;
			if (city == 0) {
				sbw_s = beijing_subway.split("$");
				map_s = beijing_map.split("$");
			}
			else {
				sbw_s = wuhan_subway.split("$");
				map_s = wuhan_map.split("$");
			}
			line_count = sbw_s.length / 2;
			point_count = 0;
			point_index.clear();
			for (let i = 0; i < line_count; ++i) {
				let tmp = sbw_s[i * 2].split(' ');
				line_name[i] = tmp[0];
				line_time[i] = { op: 0, ed: 23 };
				if (tmp.length > 1) {
					line_time[i] = { op: Number(tmp[1]), ed: Number(tmp[2]) };
				}
				line[i] = sbw_s[i * 2 + 1].split(" ");
				for (let x of line[i]) {
					if (!point_index.has(x)) {
						point_index.set(x, point_count);
						point_name[point_count] = x;
						is_change[point_count] = false;
						point_count += 1;
					}
					else {
						is_change[point_index.get(x)] = true;
					}
				}
			}
			for (let i = 0; i < line_count; ++i) {
				let x = map_s[i].split(' ');
				for (let id = 0; id < line_count; ++id) {
					if (line_name[id] == x[0]) {
						line_color[id] = { r: Number(x[1]), g: Number(x[2]), b: Number(x[3]) };
						break;
					}
				}
			}

			for (let i = 0; i < point_count; ++i) {
				let tmp = map_s[i + line_count].split(' ');
				let id = point_index.get(tmp[0]);
				if (point_pos[id]) {
					show(`repeat !! ${tmp[0]}`);
				}
				point_pos[id] = { x: Number(tmp[1]), y: Number(tmp[2]) };
			}
			line = line.map((x) => {
				return x.map((y) => {
					return point_index.get(y);
				});
			});
		}
		/*help functions*/
		function draw_line(startX, startY, endX, endY, container, id, x, y) {
			let step = Math.max(Math.abs(endX - startX), Math.abs(endY - startY)) / 3;
			let stepx = (endX - startX) / step;
			let stepy = (endY - startY) / step;
			for (let i = 0; i < step; ++i) {
				createPoint(container, startX + stepx * i, startY + stepy * i, id, x, y);
			}
			return;
		}
		function createPoint(container, x, y, id, xx, yy) {
			let node = $('<div></div>');
			node.addClass('line');
			node.addClass(`line${id}`);
			node.addClass(`edge${xx}-${yy}`);
			node.addClass(`edge${yy}-${xx}`);
			node.css("top", x)
			node.css("left", y);
			let col = line_color[id];
			node.css("background-color", `rgb(${col.r}, ${col.g}, ${col.b})`);
			container.append(node);
		}
		function draw_point(x, y, f, map, id) {
			let node = $('<div></div>');
			node.addClass('point-bg');
			node.addClass(`point${id}`);
			node.css("top", x - 2);
			node.css("left", y - 2);
			map.append(node);
			let node1 = $('<div></div>');
			node1.addClass('point-l');
			node1.css("top", x - 2);
			node1.css("left", y - 2);
			map.append(node1);
			if (f) {
				let node2 = $('<div></div>');
				node2.addClass('point-s');
				node2.css("top", x);
				node2.css("left", y);
				map.append(node2);
			}
			let node3 = $('<div></div>').text(point_name[id]);
			node3.addClass('point-n');
			node3.css("top", x + 5);
			node3.css("left", y + 5);
			map.append(node3);
		}
		function draw_input(map) {
			let sbox = $("<input></input>");
			sbox.attr('placeholder', '请输入起点');
			sbox.attr('id', "start-input");
			let tbox = $("<input></input>");
			tbox.attr('placeholder', '请输入终点');
			tbox.attr('id', "end-input");
			let btn = $("<button>查询路径</button>");
			btn.attr('id', 'path1');
			btn.on('click', path1);
			let node = $("<div></div>");
			node.attr('id', 'input-container');
			node.append(sbox);
			node.append(tbox);
			node.append(btn);
			node.append($('<div>剩余站数：<span id="rest">0</span></div>'));
			map.append(node);
		}
		function path1() {
			let ops = $('#start-input').val();
			let eds = $('#end-input').val();
			show(`ops = ${ops}, eds = ${eds}`);
			if (!point_index.has(ops) || !point_index.has(eds)) {
				alert('无效的站点名，请重新输入！');
				return;
			}
			let op = point_index.get(ops);
			let ed = point_index.get(eds);
			showing_path = get_path_1(op, ed);
			showing_id = 0;
			showing_handle = setInterval(() => {
				showing_id += 1;
				if (showing_id == showing_path.length) {
					clearInterval(showing_handle);
					clearInterval(flick_handle);
					// clear map
					setTimeout(() => {
						for (let i = 1; i < showing_path.length; ++i) {
							let x = showing_path[i];
							let pre = showing_path[i - 1];
							$(`.point${x}`).toggleClass('bg-grey', false);
							$(`.edge${x}-${pre}`).toggleClass('bg-grey', false);
						}
						$(`.point${showing_path[0]}`).toggleClass('bg-grey', false);
					}, 1000);
				}
				let x = showing_path[showing_id];
				let pre = showing_path[showing_id - 1];
				$(`.point${pre}`).toggleClass('bg-grey', true);
				$(`.edge${x}-${pre}`).toggleClass('bg-grey', true);
				let r = showing_path.length - showing_id;
				$("#rest").text(`${r}`);
			}, 1000);
			flick_handle = setInterval(() => {
				$(`.point${showing_path[showing_id]}`).toggleClass('bg-grey');
			}, 200);
		}
		function get_path_1(s, t) {
			let fun = 2;
			if (s == t) {//如果起点就是终点
				show('起点==终点，退出');
				return [s];
			}
			// build_graph_normal();//建图
			let edge = [];
			let dis = [];
			let q = [];
			let from = [];
			let pre = [];
			for (let i = 0; i < point_count; ++i) {
				dis[i] = INF;
				edge[i] = [];
			}
			for (let l of line) {
				for (let i = 1; i < l.length; ++i) {
					let x = l[i], y = l[i - 1];
					edge[x].push(y);
					edge[y].push(x);
				}
			}
			dis[s] = 0;
			q.push(s);
			while (q.length > 0) {
				let x = q.shift();
				for (let y of edge[x]) {
					if (dis[y] == INF) {
						dis[y] = dis[x] + 1;
						pre[y] = x;
						q.push(y);
					}
				}
				if (dis[t] != INF) {
					break;
				}
			}
			let ans = [];
			while (s != t) {
				ans.unshift(t);
				t = pre[t];
			}
			ans.unshift(s);
			return ans;
		}
	</script>
	<style>
		#map-container {
			left: 0;
			top: 0;
			height: 1080px;
			width: 1920px;
			position: fixed;
		}

		div.line {
			position: fixed;
			z-index: 2;
			width: 7px;
			height: 7px;
			border-radius: 100%;
			overflow: hidden;
		}

		div.point-bg {
			position: fixed;
			z-index: 4;
			width: 10px;
			height: 10px;
			border-radius: 100%;
			background-color: white;
			overflow: hidden;
		}

		.bg-grey {
			background-color: grey !important;
		}

		div.point-l {
			position: fixed;
			z-index: 5;
			width: 10px;
			height: 10px;
			border-radius: 100%;
			overflow: hidden;
			border: 1px solid black;
		}

		div.point-s {
			position: fixed;
			z-index: 6;
			width: 6px;
			height: 6px;
			border-radius: 100%;
			overflow: hidden;
			border: 1px solid black;
		}

		div.point-n {
			position: fixed;
			z-index: 3;
			font-size: 7px;
		}

		#input-container {
			position: fixed;
			top: 0px;
			left: 0px;

		}
	</style>
</head>

<body>
	<div id="map-container"></div>
</body>

</html>